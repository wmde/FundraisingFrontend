{%- set formattedAmount = donation.amount|localizedcurrency('Euro', 'de_DE') -%}
{$ greeting_generator.createFormalGreeting( recipient.lastName, recipient.salutation, recipient.title )|raw $}

{% if donation.needsModeration %}{# Moderated emails look completely different #}
	{$ mail_content('donation_confirmation/needs_moderation', {
		'formatted_amount': formattedAmount
	}) $}
	{$ mail_content('donation_confirmation/greetings', {
		'day_of_the_week': "now"|date("N")|trans({}, 'daysOfTheWeek')
	}) $}
{% else %}
	{% if donation.paymentType == 'UEB' %}
		{$ mail_content('donation_confirmation/paymenttype_banktransfer', {
			'formatted_amount': formattedAmount,
			'bank_transfer_code': donation.bankTransferCode,
			'donation_id': donation.id
		}) $}

		{% if donation.interval > 0 %}
			{$ mail_content('donation_confirmation/paymenttype_banktransfer_interval', {
				'donation_interval': ( 'donation_payment_interval_' ~ donation.interval ) | trans
			}) -$}
		{% else %}
			{$ mail_content('donation_confirmation/paymenttype_banktransfer_once') $}
		{% endif %}
	{% else %}{# All payment methods except UEB share the same intro #}
		{$- mail_content('donation_confirmation/payment_intro', {
			'formatted_amount': formattedAmount,
			'donation_id': donation.id
		}) $}
	{% endif %}
	{% if donation.paymentType == 'BEZ' %}

		{$ mail_content('donation_confirmation/paymenttype_directdebit', {
			'formatted_amount': formattedAmount
		}) $}
	{% elseif donation.paymentType == 'PPL' or donation.paymentType == 'MCP' or donation.paymentType == 'SUB' %}
		{$- mail_content('donation_confirmation/paymenttype_external', {
			'formatted_amount': formattedAmount,
			'payment_provider': donation.paymentType|trans({}, 'paymentTypes')
		}) -$}
		{% if donation.interval > 0 %}
			{$- mail_content('donation_confirmation/payment_interval_recurring') $}
		{%  else %}
			{$- mail_content('donation_confirmation/payment_interval_once') $}
		{% endif %}
	{% endif %}
	{% if donation.receiptOptIn %}

		{$ mail_content('donation_confirmation/receipt', {
			'donation_interval': donation.interval
		}) $}
	{% endif %}

	{$ mail_content('donation_confirmation/receipt_support' ) -$}
	{% if donation.receiptOptIn == false %}
		{$- " " -$}
		{$- mail_content('donation_confirmation/receipt_opted_out') $}
	{% endif %}

	{$ mail_content('donation_confirmation/greetings', {
		'day_of_the_week': "now"|date("N")|trans({}, 'daysOfTheWeek')
	}) $}
	{% if donation.paymentType == 'MCP' and donation.interval > 0 %}

		{$ mail_content('donation_confirmation/creditcard_interval_notice') $}
	{% endif %}
{% endif %}

{$ mail_content('name_head_of_suborganization') $}
{$ mail_content('title_head_of_suborganization') -$}